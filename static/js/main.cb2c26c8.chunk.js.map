{"version":3,"sources":["__data__/actionTypes.js","components/Loader/Loader.jsx","__data__/actions/bonds.js","App.jsx","utils/mapBondsToState.js","__data__/reducers/bonds.js","__data__/reducers/index.js","__data__/store.js","index.js"],"names":["BONDS_REQUEST_START","Symbol","BONDS_REQUEST_SUCCESS","BONDS_REQUEST_FAIL","Loader","className","style","margin","variant","display","alignItems","marginRight","animation","bondsFetchFails","payload","type","fetchBonds","dispatch","a","axios","get","OFZ","CORP","response","data","securities","BondsTable","React","lazy","App","useDispatch","useEffect","Container","fluid","fallback","daysTillRefund","bond","differenceInCalendarDays","Date","filterBonds","isValid","includes","bondsData","filter","map","fullPrice","couponsLeft","Math","floor","calculateCoupons","profit","percentProfit","daysTillEnd","yearProfit","key","title","price","couponValue","nextCoupon","nkd","matDate","couponInterval","initialState","isLoading","isLoaded","error","bonds","state","action","mapBondsToState","reduxReducers","combineReducers","reducers","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","applyMiddleware","thunk","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.cb2c26c8.chunk.js","sourcesContent":["export const BONDS_REQUEST_START = Symbol('bonds-request-start');\nexport const BONDS_REQUEST_SUCCESS = Symbol('bonds-request-success');\nexport const BONDS_REQUEST_FAIL = Symbol('bonds-request-fail');\n","import React from 'react';\nimport { Alert, Spinner } from 'react-bootstrap';\n\nconst Loader = () => (\n    <div className=\"center-block\" style={{ margin: '40px' }}>\n        <Alert variant={'info'}>\n            <div style={{ display: 'flex', alignItems: 'center' }}>\n                <Spinner style={{ marginRight: '20px' }} animation=\"border\" /> {' '}\n                Загрузка... подождите\n            </div>\n        </Alert>\n    </div>\n);\n\nexport default Loader;\n","import axios from 'axios';\nimport { BONDS_REQUEST_FAIL, BONDS_REQUEST_START, BONDS_REQUEST_SUCCESS } from '../actionTypes';\n\nexport const bondsFetchStart = () => ({\n  type: BONDS_REQUEST_START,\n});\n\nexport const bondsFetchSuccess = (payload) => ({\n  type: BONDS_REQUEST_SUCCESS,\n  payload,\n});\n\nexport const bondsFetchFails = (payload) => ({\n  type: BONDS_REQUEST_FAIL,\n  payload,\n});\n\nexport const fetchBonds = () => async (dispatch) => {\n  dispatch(bondsFetchStart());\n  try {\n    const OFZ = await axios.get('https://iss.moex.com/iss/engines/stock/markets/bonds/boards/TQOB/securities.json');\n    const CORP = await axios.get('https://iss.moex.com/iss/engines/stock/markets/bonds/boards/TQCB/securities.json');\n    const response = [...OFZ.data.securities.data, ...CORP.data.securities.data];\n    dispatch(bondsFetchSuccess(response));\n  } catch (err) {\n    dispatch(bondsFetchFails(err));\n  }\n};\n","import React, { Suspense, useEffect } from 'react';\nimport { useDispatch } from 'react-redux';\n\nimport { Container } from 'react-bootstrap';\nimport { fetchBonds } from './__data__/actions';\nimport Loader from './components/Loader/Loader.jsx';\n\nconst BondsTable = React.lazy(() => import('./components/BondsTable/BondsTable.jsx'));\n\nfunction App() {\n  const dispatch = useDispatch();\n  useEffect(() => {\n    dispatch(fetchBonds());\n  }, [dispatch]);\n  return (\n      <div className=\"App\">\n          <Container fluid>\n          <Suspense fallback={Loader}\n          >\n            <BondsTable />\n          </Suspense>\n          </Container>\n      </div>\n  );\n}\n\nexport default App;\n","import differenceInCalendarDays from 'date-fns/differenceInCalendarDays';\n\nconst daysTillRefund = (bond) => differenceInCalendarDays(new Date(bond[13]), new Date());\n\nconst calculateCoupons = (bond) => Math.floor(daysTillRefund(bond) / bond[15]) + 1;\n\nconst filterBonds = (bond) => {\n  const isOFZ = bond[20].includes('ОФЗ');\n  const isValid = isOFZ ? bond[20].includes('ОФЗ-ПД') : true;\n  return bond[3] && bond[5] && bond[13] !== '0000-00-00' && bond[34] === 1 && isValid && bond[26] === 'SUR';\n};\n\nexport default (bondsData) => {\n  const bonds = bondsData;\n  return bonds\n    .filter(filterBonds)\n    .map((bond) => {\n      const fullPrice = (((+bond[8] * +bond[10]) / 100) + +bond[7]) * 1.00062;\n      const couponsLeft = calculateCoupons(bond);\n      const profit = couponsLeft * bond[5] * 0.87 + bond[10] - fullPrice;\n      const percentProfit = profit / fullPrice;\n      const daysTillEnd = daysTillRefund(bond);\n      const yearProfit = (percentProfit * 365) / daysTillEnd;\n      return {\n        key: bond[0],\n        title: bond[2],\n        price: bond[3],\n        couponValue: bond[5],\n        nextCoupon: new Date(bond[6]),\n        nkd: bond[7],\n        matDate: new Date(bond[13]),\n        fullPrice,\n        couponInterval: bond[15],\n        couponsLeft,\n        profit,\n        yearProfit,\n        daysTillEnd,\n      };\n    })\n    .filter((bond) => bond.profit > 0 && bond.yearProfit < 1);\n};\n","import { BONDS_REQUEST_FAIL, BONDS_REQUEST_START, BONDS_REQUEST_SUCCESS } from '../actionTypes';\nimport mapBondsToState from '../../utils/mapBondsToState';\n\nconst initialState = {\n  isLoading: false,\n  isLoaded: false,\n  error: null,\n  data: [],\n};\n\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case BONDS_REQUEST_START: {\n      return {\n        ...state,\n        isLoading: true,\n        isLoaded: false,\n      };\n    }\n    case BONDS_REQUEST_SUCCESS: {\n      return {\n        ...state,\n        isLoading: false,\n        isLoaded: true,\n        data: mapBondsToState(action.payload),\n        error: null,\n      };\n    }\n    case BONDS_REQUEST_FAIL: {\n      return {\n        ...state,\n        isLoading: false,\n        isLoaded: false,\n        data: [],\n        error: action.payload,\n      };\n    }\n    default:\n      return state;\n  }\n};\n","import bonds from './bonds';\n\nexport default {\n  bonds,\n};\n","import {\n  applyMiddleware, combineReducers, compose, createStore,\n} from 'redux';\nimport thunk from 'redux-thunk';\nimport reducers from './reducers';\n\nconst reduxReducers = combineReducers({ ...reducers });\n// eslint-disable-next-line\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\nconst store = createStore(reduxReducers, composeEnhancers(\n  applyMiddleware(thunk),\n));\n\nexport default store;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport { Provider } from 'react-redux';\nimport App from './App.jsx';\nimport store from './__data__/store';\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nReactDOM.render(\n  <React.StrictMode>\n      <Provider store={store}>\n          <App />\n      </Provider>\n\n  </React.StrictMode>,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}